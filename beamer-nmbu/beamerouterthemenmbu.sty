% NMBU Beamer Theme
%
% Description:
%   A Beamer template consistent with NMBU graphical profile
%
% URL: https://design.nmbu.no/artikler/node/2970
%
% Author: Erlend Dancke Sandorf
%
% Based on: Beamer-NMBU by Eivysaur (https://github.com/Eivysaur/Beamer-NMBU)
\mode<presentation>
  
% ----
% FRAMETITLE
% ----
\defbeamertemplate*{frametitle}{NMBU}[1][]{
  \begin{beamercolorbox}[wd = .85\paperwidth]{frametitle}
    \vskip.75ex
    \insertframetitle
  \end{beamercolorbox}
}

% ----
% FOOTLINE
% ----
% Define the progressbar
\def\progressbar@progressbar{}
\newcount\progressbar@tmpcounta
\newcount\progressbar@tmpcountb
\newdimen\progressbar@pbht 		%	height of the progressbar
\newdimen\progressbar@pbwd 		%	width of the progressbar
\newdimen\progressbar@rcircle 	% 	Radius for the circle
\newdimen\progressbar@tmpdim		%	auxiliary dimension

\progressbar@pbwd = .84\paperwidth
\progressbar@pbht = 0.2ex

%	Now we create the progressbar
\def\progressbar@progressbar{ %
	\progressbar@tmpcounta = \insertframenumber
	\progressbar@tmpcountb = \inserttotalframenumber
	\progressbar@tmpdim = .5\progressbar@pbwd
	\multiply\progressbar@tmpdim by \progressbar@tmpcounta
	\divide\progressbar@tmpdim by \progressbar@tmpcountb
	\progressbar@tmpdim = 2\progressbar@tmpdim
	
  \begin{tikzpicture}%[very thin]
    % Create the background rectangle
    \shade[top color = nmbulightgreen, bottom color = nmbulightgreen, middle color = nmbulightgreen](0pt, 0pt) rectangle ++ (\progressbar@pbwd, \progressbar@pbht);
    
    % Create the foreground rectangle
    \shade[top color = nmbugreen, bottom color = nmbugreen, middle color = nmbugreen] (0pt, 0pt) rectangle ++ (\progressbar@tmpdim, \progressbar@pbht);
  \end{tikzpicture}%
}

\defbeamertemplate*{footline}{nmbu}[1][]{%

	\ifbeamercolorempty[bg]{footline}{}{\nointerlineskip}%
	\setbeamercolor{footlinecolor}{fg = nmbugreen, bg = nmbugreen}
	
	\ifnum\thepage=2\relax%
    \setbeamercolor{footlinecolor}{fg = white, bg = nmbugreen}
    \begin{beamercolorbox}[wd = .84\paperwidth, ht = 0.2ex, leftskip = .08\paperwidth]{title in head/foot}%
      \begin{tikzpicture}
        \draw[white] (0.08\paperwidth, 1) -- (0.92\paperwidth, 1);
      \end{tikzpicture}
    \end{beamercolorbox}
  \fi
  
  \ifnum\thepage>2\relax%
    \setbeamercolor{footlinecolor}{fg = nmbugreen, bg = white}
    
    \begin{beamercolorbox}[wd = .84\paperwidth, ht = 0.2ex, leftskip = .08\paperwidth]{title in head/foot}%
      \progressbar@progressbar
    \end{beamercolorbox}
  \fi
  
  \ifnum\thepage=\inserttotalframenumber\relax%
    \setbeamercolor{footlinecolor}{fg = nmbugreen, bg = nmbugreen}
  \fi
  
  \begin{beamercolorbox}[wd = \paperwidth, ht = 4ex, dp = 1ex, sep = 0pt, leftskip = .08\paperwidth, rightskip = .08\paperwidth]{footlinecolor}
    \insertframenumber \hfill Norwegian University of Life Sciences
  \end{beamercolorbox}
}

\mode<all>